"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5498],{5498:(E,_,m)=>{m.r(_),m.d(_,{NewHuespedPageModule:()=>Y});var l=m(6895),s=m(4006),a=m(1082),u=m(4074),p=m(655),e=m(4650),f=m(9588);const h=["inname"];function y(o,n){if(1&o&&(e.TgZ(0,"div",27),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.message," ")}}function v(o,n){if(1&o&&(e.ynx(0),e.YNc(1,y,2,1,"div",26),e.BQk()),2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(i.myForm.get("name").dirty||i.myForm.get("name").touched)&&i.myForm.get("name").hasError(t.type))}}function x(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"ion-select-option",28),e._uU(2),e.qZA(),e.BQk()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("value",t.name),e.xp6(1),e.Oqu(t.name)}}function Z(o,n){if(1&o&&(e.TgZ(0,"div",27),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.message," ")}}function w(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Z,2,1,"div",26),e.BQk()),2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(i.myForm.get("room").dirty||i.myForm.get("room").touched)&&i.myForm.get("room").hasError(t.type))}}function T(o,n){if(1&o&&(e.TgZ(0,"div",27),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.message," ")}}function N(o,n){if(1&o&&(e.ynx(0),e.YNc(1,T,2,1,"div",26),e.BQk()),2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(i.myForm.get("phone").dirty||i.myForm.get("phone").touched)&&i.myForm.get("phone").hasError(t.type))}}function F(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"ion-item",5)(1,"ion-label",6),e._uU(2,"Precio"),e.qZA(),e.TgZ(3,"ion-input",29),e.NdJ("change",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.getRest(r.myForm.get("price").value,r.myForm.get("advance").value))}),e.qZA()()}}function b(o,n){1&o&&(e.ynx(0),e.TgZ(1,"div",27),e._uU(2),e.qZA(),e.BQk()),2&o&&(e.xp6(2),e.hij(" ","El precio debe ser mayor que 1000"," "))}function A(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"ion-item",5)(1,"ion-label",6),e._uU(2,"Anticipo"),e.qZA(),e.TgZ(3,"ion-input",30),e.NdJ("change",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.getRest(r.myForm.get("price").value,r.myForm.get("advance").value))}),e.qZA()()}}function H(o,n){1&o&&(e.ynx(0),e.TgZ(1,"div",27),e._uU(2),e.qZA(),e.BQk()),2&o&&(e.xp6(2),e.hij(" ","El anticipo debe ser mayor que 500"," "))}function q(o,n){if(1&o&&(e.TgZ(0,"ion-item")(1,"ion-label",31),e._uU(2),e.ALo(3,"currency"),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(2),e.hij("Resto: ",e.lcZ(3,1,t.rest),"")}}function P(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"ion-datetime",32),e.NdJ("ionChange",function(){e.CHM(t),e.oxw();const r=e.MAs(65);return e.KtG(r.dismiss())}),e.TgZ(1,"span",33),e._uU(2,"Selecciona la fecha de ingreso"),e.qZA()()}if(2&o){const t=e.oxw(2);e.Q6J("min",t.today)}}function C(o,n){if(1&o&&(e.TgZ(0,"div",27),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.message," ")}}function M(o,n){if(1&o&&(e.ynx(0),e.YNc(1,C,2,1,"div",26),e.BQk()),2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(i.myForm.get("dateAdmission").dirty||i.myForm.get("dateAdmission").touched)&&i.myForm.get("dateAdmission").hasError(t.type))}}function J(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"ion-datetime",34),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.getForm())})("ionChange",function(){e.CHM(t),e.oxw();const r=e.MAs(75);return e.KtG(r.dismiss())}),e.TgZ(1,"span",33),e._uU(2,"Selecciona la fecha de salida"),e.qZA()()}if(2&o){const t=e.oxw(2);e.Q6J("min",t.dayDeparture)}}function Q(o,n){if(1&o&&(e.TgZ(0,"div",27),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.message," ")}}function D(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Q,2,1,"div",26),e.BQk()),2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(i.myForm.get("departureDate").dirty||i.myForm.get("departureDate").touched)&&i.myForm.get("departureDate").hasError(t.type))}}function k(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"form",4)(1,"ion-grid")(2,"ion-row")(3,"ion-col")(4,"ion-item",5)(5,"ion-label",6),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"ion-input",7,8),e.qZA(),e.TgZ(9,"div"),e.YNc(10,v,2,1,"ng-container",9),e.qZA()()(),e.TgZ(11,"ion-row")(12,"ion-col",10)(13,"ion-item",5)(14,"ion-select",11),e.NdJ("ionChange",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.changeRoom())}),e.YNc(15,x,3,2,"ng-container",9),e.qZA()(),e.TgZ(16,"div"),e.YNc(17,w,2,1,"ng-container",9),e.qZA()()(),e.TgZ(18,"ion-row")(19,"ion-col",10)(20,"ion-item",5)(21,"ion-segment",12)(22,"ion-segment-button",13)(23,"ion-label"),e._uU(24,"Mujer"),e.qZA()(),e.TgZ(25,"ion-segment-button",14)(26,"ion-label"),e._uU(27,"Hombre"),e.qZA()()()()()(),e.TgZ(28,"ion-row")(29,"ion-col",10)(30,"ion-item",5)(31,"ion-label",6),e._uU(32,"Tel\xe9fono"),e.qZA(),e._UZ(33,"ion-input",15),e.qZA(),e.TgZ(34,"div"),e.YNc(35,N,2,1,"ng-container",9),e.qZA()()(),e.TgZ(36,"ion-row")(37,"ion-col",10)(38,"ion-item",5)(39,"ion-segment",16),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.changeRoom())}),e.TgZ(40,"ion-segment-button",17)(41,"ion-label"),e._uU(42,"Airbnb"),e.qZA()(),e.TgZ(43,"ion-segment-button",18)(44,"ion-label"),e._uU(45,"Directo"),e.qZA()()()()()(),e.TgZ(46,"ion-row")(47,"ion-col",10),e.YNc(48,F,4,0,"ion-item",19),e.TgZ(49,"div"),e.YNc(50,b,3,1,"ng-container",20),e.qZA()()(),e.TgZ(51,"ion-row")(52,"ion-col",10),e.YNc(53,A,4,0,"ion-item",19),e.TgZ(54,"div"),e.YNc(55,H,3,1,"ng-container",20),e.qZA()()(),e.TgZ(56,"ion-row")(57,"ion-col",10),e.YNc(58,q,4,3,"ion-item",20),e.qZA()(),e.TgZ(59,"ion-row")(60,"ion-col",10)(61,"ion-item",5),e._uU(62," Entrada:\xa0 "),e._UZ(63,"ion-datetime-button",21),e.TgZ(64,"ion-modal",22,23),e.YNc(66,P,3,1,"ng-template"),e.qZA()(),e.TgZ(67,"div"),e.YNc(68,M,2,1,"ng-container",9),e.qZA()()(),e.TgZ(69,"ion-row")(70,"ion-col",10)(71,"ion-item",5),e._uU(72," Salida:\xa0 "),e._UZ(73,"ion-datetime-button",24),e.TgZ(74,"ion-modal",22,25),e.YNc(76,J,3,1,"ng-template"),e.qZA()(),e.TgZ(77,"div"),e.YNc(78,D,2,1,"ng-container",9),e.qZA()()()()()}if(2&o){const t=e.oxw();e.Q6J("formGroup",t.myForm),e.xp6(7),e.Q6J("autofocus",!0),e.xp6(3),e.Q6J("ngForOf",t.validatorMessages.name),e.xp6(5),e.Q6J("ngForOf",t.rooms),e.xp6(2),e.Q6J("ngForOf",t.validatorMessages.room),e.xp6(18),e.Q6J("ngForOf",t.validatorMessages.phone),e.xp6(13),e.Q6J("ngIf","direct"===t.myForm.get("platform").value),e.xp6(2),e.Q6J("ngIf",(t.myForm.get("price").dirty||t.myForm.get("price").touched)&&"direct"===t.myForm.get("platform").value&&t.myForm.get("price").value<1e3),e.xp6(3),e.Q6J("ngIf","direct"===t.myForm.get("platform").value),e.xp6(2),e.Q6J("ngIf",(t.myForm.get("advance").dirty||t.myForm.get("advance").touched)&&"direct"===t.myForm.get("platform").value&&t.myForm.get("advance").value<500),e.xp6(3),e.Q6J("ngIf","direct"===t.myForm.get("platform").value),e.xp6(6),e.Q6J("keepContentsMounted",!0),e.xp6(4),e.Q6J("ngForOf",t.validatorMessages.dateAdmission),e.xp6(6),e.Q6J("keepContentsMounted",!0),e.xp6(4),e.Q6J("ngForOf",t.validatorMessages.departureDate)}}const U=[{path:"",component:(()=>{class o{constructor(t,i,r,d){this.huespedService=t,this.fb=i,this.router=r,this.toastController=d,this.isContentLoaded=!1,this.rest=0,this.huespedsDates=[{name:"",phone:"",dateAdmission:"",departureDate:"",room:"",token:"",gender:"",platform:"Airbnb",price:0,advance:0}],this.getDate(),this.huespedService.getRooms().subscribe(g=>{this.rooms=g,this.roomSelected=g[0]}),this.myForm=this.fb.group({name:["",s.kI.required],phone:["",s.kI.compose([s.kI.required,s.kI.minLength(12),s.kI.maxLength(17),s.kI.pattern(/\+\d+/)])],dateAdmission:[this.today,s.kI.required],departureDate:[this.dayDeparture,s.kI.required],room:["Elefante",s.kI.required],gender:["woman",s.kI.required],platform:["airbnb",s.kI.required],price:[0],advance:[0]}),this.validatorMessages={name:[{type:"required",message:"Nombre obligatorio"}],phone:[{type:"required",message:"Tel\xe9fono obligatorio"},{type:"minlength",message:"El Tel\xe9fono debe ser de m\xednimo 12 digitos"},{type:"maxlength",message:"El Tel\xe9fono debe ser de m\xe1ximo 17 digitos"},{type:"pattern",message:"El Tel\xe9fono debe ser solo la lada y los n\xfameros. Ej. +523113331111"}],dateAdmission:[{type:"required",message:"Fecha de entrada obligatoria"}],departureDate:[{type:"required",message:"Fecha de salida obligatoria"}],room:[{type:"required",message:"Cuarto obligatorio"}]},this.myForm.get("dateAdmission").valueChanges.subscribe(g=>{console.log("Fecha seleccionada: "+g);let c=new Date(g);c.setDate(c.getDate()+2),console.log("Fecha nueva: "+c),this.dayDeparture=c.getFullYear()+"-"+("0"+(c.getMonth()+1)).slice(-2)+"-"+("0"+c.getDate()).slice(-2),console.log(this.dayDeparture),this.myForm.get("departureDate").setValue(this.dayDeparture)})}ngOnInit(){}getDate(){const t=new Date;this.today=t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2),t.setDate(t.getDate()+1),this.dayDeparture=t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)}presentToast(){return(0,p.mG)(this,void 0,void 0,function*(){yield(yield this.toastController.create({message:"Huesped agregado",duration:1500,position:"bottom"})).present()})}presentToastRoom(){return(0,p.mG)(this,void 0,void 0,function*(){yield(yield this.toastController.create({message:"Habitaci\xf3n no disponible para las fechas que requiere",duration:1500,position:"bottom"})).present()})}presentToastAdvance(){return(0,p.mG)(this,void 0,void 0,function*(){yield(yield this.toastController.create({message:"Anticipo no v\xe1lido. Debe ser mayor al 30% o igual al total de la habitaci\xf3n!",duration:1500,position:"bottom"})).present()})}ionViewDidEnter(){this.isContentLoaded=!0,setTimeout(()=>{this.inName.setFocus()},2e3)}newHuesped(t){this.checkRoom(t.room,t.dateAdmission)?(t.token=Math.random().toString(36).substr(2)+Math.random().toString(36).substr(2),t.dateAdmission=t.dateAdmission.substring(0,11)+"00:00:00-07:00",t.departureDate=t.departureDate.substring(0,11)+"14:00:00-07:00",this.huesped=t,this.huespedService.newHuesped(this.huesped),this.presentToast(),this.router.navigate(["/view-huesped"])):this.presentToastRoom()}changeRoom(){let t=this.myForm.get("room").value;console.log("Room"+t);let i=this.myForm.get("platform").value;console.log("platform"+i),this.roomSelected=this.rooms.find(r=>r.name===t),console.log(this.roomSelected),"airbnb"===i?(this.myForm.get("price").setValue(0),this.myForm.get("advance").setValue(0),this.rest=0):"direct"===i&&(this.myForm.get("price").setValue(this.roomSelected.price),this.myForm.get("advance").setValue(this.roomSelected.price/2),this.rest=this.roomSelected.price/2)}checkRoom(t,i){if(this.huespedService.getHuespedByRoom(t)){this.huespedService.getFechasByRoom(t).subscribe(d=>{this.huespedsDates=d});let r=!0;return this.huespedsDates.forEach(d=>{d.departureDate.substring(0,10)>=i.substring(0,10)&&(r=!1)}),!!r}return!0}getRest(t,i){this.rest=t-i}changePrice(t){console.log(t),"airbnb"===t&&(this.myForm.get("price").setValue(0),this.myForm.get("advance").setValue(0),this.rest=0),"airbnb"===t&&(this.myForm.get("price").setValue(1150),this.myForm.get("advance").setValue(0),this.rest=0)}getForm(){console.log(this.myForm.valid)}closeModal(){}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(f.l),e.Y36(s.qu),e.Y36(u.F0),e.Y36(a.yF))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-new-huesped"]],viewQuery:function(t,i){if(1&t&&e.Gf(h,5),2&t){let r;e.iGM(r=e.CRH())&&(i.inName=r.first)}},decls:12,vars:2,consts:[["slot","start"],[3,"formGroup",4,"ngIf"],["expand","block","shape","round",3,"disabled","click"],["name","add"],[3,"formGroup"],["id","item"],["position","floating"],["formControlName","name",3,"autofocus"],["inname",""],[4,"ngFor","ngForOf"],["size","12"],["interface","popover","formControlName","room","placeholder","Selecciona la habitaci\xf3n",3,"ionChange"],["value","default","formControlName","gender"],["value","woman"],["value","man"],["type","tel","formControlName","phone"],["formControlName","platform",3,"click"],["value","airbnb"],["value","direct"],["id","item",4,"ngIf"],[4,"ngIf"],["datetime","datetime"],[3,"keepContentsMounted"],["modaldatetime",""],["datetime","datetime2"],["modaldatetime2",""],["class","errormessages",4,"ngIf"],[1,"errormessages"],[3,"value"],["type","number","formControlName","price","value","0",1,"money",3,"change"],["type","number","formControlName","advance","value","0",1,"money",3,"change"],[1,"money","restmoney"],["id","datetime","formControlName","dateAdmission","presentation","date",1,"calendar",3,"min","ionChange"],["slot","title"],["id","datetime2","presentation","date","formControlName","departureDate",1,"calendar",3,"min","click","ionChange"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Nuevo Huesped"),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-grid"),e.YNc(8,k,79,15,"form",1),e.qZA(),e.TgZ(9,"ion-button",2),e.NdJ("click",function(){return i.newHuesped(i.myForm.value)}),e._UZ(10,"ion-icon",3),e._uU(11," Guardar "),e.qZA()()),2&t&&(e.xp6(8),e.Q6J("ngIf",i.isContentLoaded),e.xp6(1),e.Q6J("disabled",!i.myForm.valid))},dependencies:[l.sg,l.O5,s._Y,s.JJ,s.JL,s.sg,s.u,a.oU,a.YG,a.Sm,a.wI,a.W2,a.x4,a.Mj,a.jY,a.Gu,a.gu,a.pK,a.Ie,a.Q$,a.Nd,a.cJ,a.GO,a.t9,a.n0,a.wd,a.sr,a.ki,a.as,a.QI,a.j9,a.cs,l.H9],styles:["#item[_ngcontent-%COMP%]{padding-top:10px}.calendar[_ngcontent-%COMP%]{height:450px;color:#000}.errormessages[_ngcontent-%COMP%]{color:red;text-align:right;padding-right:10px;font-style:italic;font-size:13px}.money[_ngcontent-%COMP%]{text-align:right;font-size:18px;font-weight:700}.restmoney[_ngcontent-%COMP%]{font-size:18px;font-weight:700}"]}),o})()}];let I=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[u.Bz.forChild(U),u.Bz]}),o})(),Y=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[l.ez,s.u5,s.UX,a.Pc,I]}),o})()}}]);