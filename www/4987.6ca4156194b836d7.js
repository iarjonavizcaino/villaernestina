"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4987],{4987:(S,v,r)=>{r.r(v),r.d(v,{LoginPageModule:()=>C});var f=r(6895),a=r(4006),s=r(1082),p=r(4074),d=r(655),e=r(4650),y=r(9588),_=r(849);const k=["input"];function T(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"ion-item",9)(1,"ion-label",10),e._uU(2,"Token"),e.qZA(),e.TgZ(3,"ion-input",11,12),e.NdJ("keyup.enter",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.login(o.myForm.value))}),e.qZA()()}}function L(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"ion-content",1)(1,"ion-card",2)(2,"div",3),e._UZ(3,"img",4),e.qZA(),e.TgZ(4,"ion-card-header",5)(5,"ion-card-subtitle"),e._uU(6,"Capture su token de acceso"),e.qZA(),e.TgZ(7,"ion-card-title"),e._uU(8,"Login"),e.qZA()(),e.TgZ(9,"ion-card-content")(10,"form",6),e.YNc(11,T,5,0,"ion-item",7),e.TgZ(12,"ion-row")(13,"ion-col")(14,"ion-button",8),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.login(o.myForm.value))}),e._uU(15,"Sign In"),e.qZA()()()()()()()}if(2&i){const t=e.oxw();e.Q6J("fullscreen",!0),e.xp6(10),e.Q6J("formGroup",t.myForm),e.xp6(1),e.Q6J("ngIf",t.isContentLoaded)}}const P=[{path:"",component:(()=>{class i{constructor(t,n,o,g,c,u,h){this.loadingCtrl=t,this.route=n,this.fb=o,this.toastController=g,this.router=c,this.huespedService=u,this.storage=h,this._storage=null,this.isContentLoaded=!1}showLoading(){return(0,d.mG)(this,void 0,void 0,function*(){(yield this.loadingCtrl.create({message:"Loading...",duration:3e3,spinner:"circles"})).present()})}ngOnInit(){return(0,d.mG)(this,void 0,void 0,function*(){this.showLoading(),this.myForm=this.fb.group({token:""}),this._storage=yield this.storage.create(),yield this.verifyToken()})}ionViewDidEnter(){this.isContentLoaded=!0}verifyToken(){return(0,d.mG)(this,void 0,void 0,function*(){this.route.queryParams.subscribe(t=>(0,d.mG)(this,void 0,void 0,function*(){var n;this.token=t.token,this.tokenstorage=yield this.storage.get("token"),this.token&&"undefined"!=this.token?(this.token!=this.tokenstorage&&(yield null===(n=this._storage)||void 0===n?void 0:n.set("token",this.token),this.tokenstorage=this.token),setTimeout(()=>(0,d.mG)(this,void 0,void 0,function*(){if(this.huesped=yield this.huespedService.getHuespedByToken(this.token),this.huesped){let o;this.huespedService.setToken(this.token),o=yield this.huespedService.getRoom(this.huesped.room),this.roomname=o.name,this.roomcode=o.code,yield this.setStorageData(),yield this.getStorageData(),console.log(this._storage),this.goToTab1(this.token)}else yield this._storage.clear(),this.router.navigate([""])}),2e3)):(this.tokenstorage&&"undefined"!=this.tokenstorage&&(this.token=this.tokenstorage),setTimeout(()=>(0,d.mG)(this,void 0,void 0,function*(){if(this.huesped=yield this.huespedService.getHuespedByToken(this.token),this.huesped){let o;this.huespedService.setToken(this.token),o=yield this.huespedService.getRoom(this.huesped.room),this.roomname=o.name,this.roomcode=o.code,yield this.setStorageData(),yield this.getStorageData(),console.log(this._storage),this.goToTab1(this.token)}else yield this._storage.clear(),this.router.navigate([""])}),2e3))}))})}setStorageData(){var t,n,o,g,c,u,h,m;return(0,d.mG)(this,void 0,void 0,function*(){yield null===(t=this._storage)||void 0===t?void 0:t.set("name",this.huesped.name),yield null===(n=this._storage)||void 0===n?void 0:n.set("roomname",this.roomname),yield null===(o=this._storage)||void 0===o?void 0:o.set("roomcode",this.roomcode),yield null===(g=this._storage)||void 0===g?void 0:g.set("admisiondate",this.huesped.dateAdmission),yield null===(c=this._storage)||void 0===c?void 0:c.set("departuredate",this.huesped.departureDate),yield null===(u=this._storage)||void 0===u?void 0:u.set("price",this.huesped.price),yield null===(h=this._storage)||void 0===h?void 0:h.set("advance",this.huesped.advance),yield null===(m=this._storage)||void 0===m?void 0:m.set("platform",this.huesped.platform)})}getStorageData(){var t,n,o,g,c,u,h,m;return(0,d.mG)(this,void 0,void 0,function*(){console.log(yield null===(t=this._storage)||void 0===t?void 0:t.get("name")),console.log(yield null===(n=this._storage)||void 0===n?void 0:n.get("roomname")),console.log(yield null===(o=this._storage)||void 0===o?void 0:o.get("roomcode")),console.log(yield null===(g=this._storage)||void 0===g?void 0:g.get("admisiondate")),console.log(yield null===(c=this._storage)||void 0===c?void 0:c.get("departuredate")),console.log(yield null===(u=this._storage)||void 0===u?void 0:u.get("price")),console.log(yield null===(h=this._storage)||void 0===h?void 0:h.get("advance")),console.log(yield null===(m=this._storage)||void 0===m?void 0:m.get("platform"))})}login(t){this.token=t.token,"admin12345"==this.token?(this.presentToast("bottom","Acceso Correcto"),this.router.navigate(["/view-huesped"])):this.huespedService.getHuespedByToken(this.token)?(this.presentToast("bottom","Ingreso correcto"),this.huespedService.setToken(this.token),this.goToTab1(this.token)):this.presentToast("bottom","Acceso Incorrecto")}goToTab1(t){this.router.navigate(["/tabs/tab1"])}presentToast(t,n){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.toastController.create({message:n,duration:1e3,position:t})).present()})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(s.HT),e.Y36(p.gz),e.Y36(a.qu),e.Y36(s.yF),e.Y36(p.F0),e.Y36(y.l),e.Y36(_.K))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-login"]],viewQuery:function(t,n){if(1&t&&e.Gf(k,5),2&t){let o;e.iGM(o=e.CRH())&&(n.myInput=o.first)}},decls:1,vars:1,consts:[["class","back",3,"fullscreen",4,"ngIf"],[1,"back",3,"fullscreen"],[1,"text-center"],[1,"divimg"],["alt","Bienvenida3","src","../../assets/img/Logosinfondo.png",1,"imglogo"],[1,"header"],[3,"formGroup"],["lines","full",4,"ngIf"],["type","submit","color","danger","expand","block",3,"click"],["lines","full"],["position","floating"],["autofocus","true","type","text","required","","formControlName","token","type","password",3,"keyup.enter"],["input",""]],template:function(t,n){1&t&&e.YNc(0,L,16,3,"ion-content",0),2&t&&e.Q6J("ngIf",!n.token||"undefined"===n.token)},dependencies:[f.O5,a._Y,a.JJ,a.JL,a.Q7,s.YG,s.PM,s.FN,s.Zi,s.tO,s.Dq,s.wI,s.W2,s.pK,s.Ie,s.Q$,s.Nd,s.j9,a.sg,a.u],styles:[".back[_ngcontent-%COMP%]{--background: #fff url(VillaErnestina0.0a92316d3844043d.png) no-repeat center center / cover}.text-center[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;--background: #ffffff;opacity:80%;margin-top:50%}.imglogo[_ngcontent-%COMP%]{width:300px}.divimg[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column}.header[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0}"]}),i})()}];let b=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[p.Bz.forChild(P),p.Bz]}),i})(),C=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[f.ez,a.u5,s.Pc,a.UX,b]}),i})()}}]);